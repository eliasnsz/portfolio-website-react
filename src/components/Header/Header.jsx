import './Header.scss'
import { useEffect, useState } from 'react'
import Menu from '../MenuHamburguer/Menu';
import { MenuContext } from '../../App';


export default function Header () {


  const [isMenuOpen, toggleMenu] = useState(false)
  
  
  const [lastPosition, setLastPosition] = useState(0);
  const [isHeaderVisible, setHeaderVisibility] = useState(true)

  if(!isMenuOpen) {
    function handleHeaderVisibility(position) {

      
      if(position === lastPosition || position < 83) return

      if (position > lastPosition) {
        setLastPosition(position)
        setHeaderVisibility(false)
      } else {
        setLastPosition(position)
        setHeaderVisibility(true)
      }
    }
  }

  window.addEventListener("scroll", e => handleHeaderVisibility(window.scrollY)) 

  useEffect(() => {
    setTimeout(() => {
      setHeaderVisibility(true);
    }, 500);
  }, [])
  
  return (
    <>
      <header className={isHeaderVisible ? "visible" : "invisible"}>
        <MenuContext.Provider value={{ isMenuOpen, toggleMenu }}>
          <Menu/>
        </MenuContext.Provider>


        <div className="limiter">
          <div className="left-header">
            <svg fill={ isMenuOpen ? "white" : "black"} className='logo' xmlns="http://www.w3.org/2000/svg" version="1.0" viewBox="0 0 512.000000 521.000000" preserveAspectRatio="xMidYMid meet">
              <g transform="translate(0.000000,521.000000) scale(0.100000,-0.100000)" stroke="none">
              <path d="M1678 4420 c-73 -57 -174 -367 -242 -745 -53 -291 -67 -435 -73 -740 -4 -269 -6 -296 -28 -370 -46 -153 -138 -316 -239 -424 l-51 -54 50 7 c42 6 56 13 87 48 46 52 127 208 164 313 15 44 30 84 35 88 4 5 10 -11 14 -35 20 -118 136 -237 233 -238 37 0 38 -4 16 -55 -16 -39 -19 -151 -6 -215 18 -89 132 -241 202 -270 17 -7 30 -18 30 -24 0 -23 -83 -162 -118 -199 -49 -51 -74 -61 -116 -43 -61 26 -92 134 -82 291 6 100 27 232 40 254 11 16 -39 14 -74 -4 -81 -42 -141 -253 -120 -424 26 -204 147 -297 295 -227 72 33 134 105 194 226 l52 105 52 3 c75 4 130 33 203 106 l64 64 0 -31 c0 -37 44 -118 86 -161 16 -16 48 -38 72 -48 120 -54 218 41 286 275 l23 79 11 -66 c20 -124 106 -191 212 -166 93 22 196 126 263 264 45 93 60 149 92 336 41 251 77 348 144 394 61 42 88 48 127 30 56 -26 69 -63 69 -184 0 -98 -2 -109 -32 -171 -18 -37 -51 -83 -74 -104 -22 -20 -39 -38 -37 -40 1 -1 27 -15 56 -29 68 -34 128 -94 157 -159 l24 -51 -28 -35 c-16 -20 -77 -90 -136 -156 -203 -227 -255 -312 -255 -421 0 -145 102 -185 267 -108 76 36 188 148 239 239 86 155 111 344 65 488 l-22 68 43 74 c24 41 46 75 49 75 4 0 9 -17 13 -38 8 -54 77 -126 134 -142 68 -18 150 9 203 67 31 32 108 174 134 246 18 49 35 48 35 -1 0 -34 75 -110 122 -123 164 -44 362 183 412 474 13 70 13 84 1 96 -12 13 -15 13 -19 0 -76 -246 -104 -311 -179 -404 -58 -72 -120 -79 -162 -16 -32 45 -33 119 -5 245 34 153 27 176 -50 176 l-46 0 -12 -45 c-53 -198 -180 -481 -247 -550 -68 -70 -125 -61 -153 22 -21 62 -24 165 -8 268 46 305 182 525 325 525 50 0 96 -51 111 -123 l12 -58 41 23 c38 21 42 28 45 65 7 98 -72 167 -193 168 -33 0 -70 -4 -82 -8 l-23 -8 25 53 c13 29 27 72 31 95 4 31 12 44 27 49 11 4 55 41 97 83 87 86 122 151 141 255 10 59 9 70 -4 84 -18 18 -15 23 -40 -73 -32 -124 -85 -211 -159 -265 -22 -16 -44 -30 -48 -30 -4 0 -11 20 -15 45 -17 116 -68 221 -208 428 -103 150 -147 240 -147 297 0 16 -4 40 -10 54 -13 35 -58 35 -91 0 -26 -28 -30 -76 -15 -199 9 -73 -19 -192 -85 -360 -34 -88 -51 -118 -85 -150 -57 -54 -67 -77 -74 -165 -8 -86 -52 -191 -120 -281 -55 -73 -95 -103 -137 -102 -100 3 -126 116 -78 340 14 65 25 128 25 140 0 32 -40 55 -90 51 l-43 -3 -61 -180 c-121 -353 -221 -528 -313 -551 -90 -23 -140 123 -115 343 33 294 161 558 302 622 57 26 87 26 127 1 43 -26 62 -57 76 -128 l12 -60 39 18 c69 32 81 81 41 168 -22 46 -31 56 -81 79 -49 22 -66 25 -133 21 -60 -4 -89 -11 -140 -37 -199 -101 -373 -389 -427 -705 -40 -237 -143 -411 -263 -447 -67 -20 -115 0 -146 61 -61 120 -57 266 15 560 22 91 40 181 40 201 0 43 -25 69 -64 69 -99 0 -174 -182 -196 -475 -6 -81 -8 -155 -5 -165 3 -11 -5 -62 -19 -115 -105 -393 -311 -461 -396 -131 -11 43 -23 113 -26 155 -6 70 -4 81 18 117 78 127 182 403 241 641 53 212 71 351 72 558 0 178 0 181 -29 243 -30 65 -84 122 -115 122 -10 0 -29 -9 -43 -20z m108 -250 c59 -163 -75 -835 -226 -1135 l-41 -80 6 130 c17 387 102 852 198 1078 23 56 44 59 63 7z m2234 -323 c0 -7 16 -36 35 -65 90 -133 180 -334 200 -446 l6 -39 -83 5 c-65 4 -95 11 -138 33 -55 28 -115 68 -157 103 l-22 19 40 93 c22 51 54 141 72 201 28 96 47 134 47 96z m-69 -528 c113 -56 150 -68 230 -75 78 -8 86 -17 63 -74 -31 -78 -150 -127 -228 -95 -106 45 -199 192 -170 269 8 22 11 21 105 -25z m-130 -266 c64 -61 149 -98 224 -96 33 1 82 9 109 17 l48 15 -19 -22 c-35 -39 -114 -174 -145 -248 -39 -92 -78 -248 -78 -310 0 -37 -10 -68 -46 -138 -25 -49 -55 -98 -65 -107 -19 -17 -21 -16 -62 23 -23 23 -72 57 -108 76 l-65 34 49 54 c117 128 155 295 97 426 -21 49 -92 100 -151 109 l-37 6 50 66 c28 36 66 98 86 138 l36 73 17 -37 c9 -20 36 -56 60 -79z m-615 -165 c32 -46 79 -76 133 -86 l41 -7 -30 -58 c-39 -73 -65 -176 -80 -308 -24 -224 -66 -358 -149 -476 -97 -138 -185 -162 -226 -61 -26 65 -29 167 -11 346 10 89 14 171 11 182 -7 21 -52 34 -100 28 l-29 -3 -31 -180 c-61 -344 -113 -493 -187 -534 -56 -32 -112 18 -146 128 -21 71 -21 311 0 419 17 83 13 90 -51 99 -34 5 -41 2 -55 -19 -25 -39 -45 -153 -51 -293 -6 -146 -18 -178 -85 -239 -52 -47 -96 -66 -154 -66 l-44 0 13 45 c8 25 22 95 31 156 20 127 11 223 -27 303 -23 50 -82 96 -122 96 -32 0 -34 10 -7 35 30 27 78 115 109 200 26 72 41 87 41 41 0 -48 71 -128 139 -158 33 -15 54 -18 90 -13 56 8 156 55 196 93 42 39 110 132 137 186 22 45 38 52 38 15 0 -25 42 -98 73 -127 28 -26 98 -52 142 -52 48 0 150 55 189 103 33 41 119 211 147 291 l14 38 7 -42 c4 -24 19 -61 34 -82z m-1331 -624 c34 -22 65 -126 65 -214 0 -74 -26 -229 -41 -244 -15 -16 -78 54 -115 129 -49 100 -60 168 -40 237 29 99 73 130 131 92z m1885 -407 c0 -106 -18 -184 -61 -273 -65 -131 -190 -251 -248 -238 -44 10 -71 49 -71 102 0 59 23 109 90 197 75 98 272 315 282 309 4 -3 8 -47 8 -97z"/>
              <path d="M660 4121 c-200 -65 -342 -223 -386 -431 -49 -230 69 -488 272 -597 l56 -30 -74 -41 c-250 -139 -418 -412 -418 -680 0 -124 56 -276 133 -359 76 -83 167 -123 438 -193 222 -58 282 -83 348 -145 69 -64 95 -128 96 -230 0 -72 -3 -86 -34 -143 -103 -189 -398 -305 -564 -222 -76 38 -123 85 -159 158 -31 62 -33 74 -33 167 0 104 8 163 26 197 16 30 4 33 -43 8 -66 -33 -125 -97 -148 -158 -24 -63 -25 -108 -5 -186 37 -140 111 -232 233 -289 56 -26 82 -31 164 -35 125 -6 221 15 336 73 303 153 432 436 313 691 -72 154 -162 206 -509 294 -277 70 -362 123 -399 250 -22 75 -12 181 28 306 75 235 203 409 378 515 l61 37 -49 30 c-75 47 -127 108 -176 207 -56 114 -74 185 -82 310 -7 118 6 190 48 274 35 69 82 114 155 148 119 54 217 33 262 -58 49 -100 37 -199 -45 -372 l-47 -99 24 -19 c14 -10 41 -23 60 -29 47 -13 76 8 112 80 72 145 49 400 -45 507 -69 79 -202 105 -327 64z"/>
              <path d="M2202 4009 c-77 -38 -133 -129 -113 -182 22 -58 108 -78 173 -40 85 49 124 175 68 222 -32 26 -74 26 -128 0z"/>
              </g>
            </svg>
          </div>
          <nav className="right-header">
            <ul>
              <li><a href="#firstSection-container">In√≠cio</a></li>
              <li><a href="#sobre">Sobre</a></li>
              <li><a href="#projetos">Projetos</a></li>
              <li><a href="#contato">Contato</a></li>
            </ul>
          </nav>
          <div id="menu-icon">
            <button id='menu-button' onClick={() => toggleMenu(!isMenuOpen)} className={isMenuOpen ? "open" : ""} >
              <div className='line'></div>
              <div className='line'></div>
              <div className='line'></div>
            </button>
          </div>
        </div>
      </header>
    </>
  )
} 